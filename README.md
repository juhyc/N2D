![멋사 캐치프라이즈](https://user-images.githubusercontent.com/66891085/148351155-642ec56e-4843-4e85-8f37-a5c973e55eb8.png)
--------------------------------------------------------------------------
## ✨프로젝트 한줄 소개✨

ZERO_DCE 모델을 이용한 쏘카 input 저조도차량파손사진 개선모델

## 🎁목차🎁


- 🤽‍♀️팀 소개
- 🍕프로젝트 소개
- 🎋느낀점

--------------------------------------------------------------------------
## 🤽‍♂️팀 소개

|Name|최주형|김두진|심영현|이태성|이창근|
|:---|:---:|---:|---:|---:|---:|
|Profile||-|-|![KakaoTalk_20220106_172658148 (1)](https://user-images.githubusercontent.com/66891085/148471052-1291b84f-eca6-4bd6-a8d6-c15772050d3d.jpg)|-|
|Position|1|2|3|4|5|
|Git|1|2|3|@2taesung|5|

--------------------------------------------------------------------------
## 🍕프로젝트 소개

1. **문제 제기**


    쏘카는 일평균 7-8만장, 최대 11만장의 차량 외관 이미지가 업로드된다고 합니다. 

    쏘카에서 진행한 [*'딥러닝모델을 이용한 차량 파손 탐지 딥러닝 모델'*](https://tech.socarcorp.kr/data/2020/02/13/car-damage-segmentation-   model.html) 은 그 중 육안으로 파손 여부를 확실히 판별할수 있는 이미지 2000장을 모델에 이용했다고 합니다.

    2000장의 이미지 중 어두운 곳에서 촬영된 차량 이미지에 모델의 정확도가 떨어지는 문제가 발생했다고 합니다.

    7만장 중에 밤에 찍은 사진이거나, 어두운 곳에서 찍은 사진이 의미 있게 쓰일수는 없을까??? 라는 생각이 들었습니다.

    딥러닝 모델을 이용하여 노이즈가 있거나 저조도의 차량파손 사진을 개선하는 것이 목표입니다.
    
  
  
2. **데이터 준비**


    쏘카에서 제공한 1.3만개의 차량 파손 데이터 중
        1. 초점이 잘 맞는 사진

        2. 파손 부위가 잘 보이는 사진
        
        3. 화질이 너무 낮지 않은 사진
    을 기준으로 400개의 이미지를 준비하였습니다.
  
  다양한 밝기에 노출된 이미지를 위해 400개의 이미지에 각각 10번의 transform을 적용하여 총 4000장의 이미지를 이용하였습니다.



3. **모델 선택**


  다음과 같은 구조를 가지는 DCE-net 모델을 사용하였습니다.
  
  <img src = "https://user-images.githubusercontent.com/42459518/148529377-607d4845-8399-4b54-8c89-a3fefb741170.png" width = "50%" height = "50%">
  


4. **모델 선택 이유**
    
    
    1. paired and unpaired 상관없는 training data 사용가능.
    2. 학습시간과 이미지처리 시간이 적게 걸림. (대략 장당 0.001~0.003초)
    


5. **학습**

    <img src = "https://user-images.githubusercontent.com/42459518/148532204-2d9d4eda-9ece-4c5a-9ca6-6c6d4a7ad890.png" width = "50%" height = "50%">
    
    전체 파라미터에서 약 20% 차지하는 마지막 층을 제외하고 freeze시킨후 마지막 층만 학습을 시키는 fine-tuning을 진행하였습니다.
    
    기존 모델은 32크기의 feature map을 이용하였는데, 차량이미지에 파손부위는 전체이미지 중 detail에 들어간다고 판단하여
    
    64크기의 feature map으로 변경하여 학습을 진행하였습니다.
    
    학습을 진행할 층 변경, batch size 변경, feature map size 변경, dataset 구성 변경등 hyperparameter tuning을 진행하였습니다.
    
    최종적으로 모델 반환 결과 detail을 많이 포함하는
    
    (4000장의 다양한 노출 이미지, batch size : 16, feature map: 64, epoch : 100) 최종 모델의 파라미터를 설정하였습니다.
    
    

5. **결과**

6. **문제점, 개선점**
--------------------------------------------------------------------------
## 🎋느낀점

- 최주형
- 김두진
- 심영현
- 이태성
- 이창근
